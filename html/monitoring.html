<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Plumed Tutorial (ASCMS, Sao Paulo, 2011): Monitoring collective variables</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Plumed Tutorial (ASCMS, Sao Paulo, 2011)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Plumed Tutorial (ASCMS, Sao Paulo, 2011)</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Monitoring collective variables </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this chapter we will see the basic instructions for creating a <code>plumed.dat</code> input files and review the output that it produces during the simulation. At the end of this chapter the user should be able to write a simple plumed input file and monitor the CVs of choice by simply consulting the manual for each CV individual syntax. The philosophy behind plumed requires that one may use the same input with different programs. This is only partly true because different programs have different internal units. Keep this in mind because it is crucial to understand which are the internal units of the program you are running before you do a simulation. It may let you save lots of human and computer time. Moreover, in all the CVs, one should specify the atoms involved in it. In different programs the atom indexing may be different.</p>
<p>LAMMPS: distances and energies should be specified as in the LAMMPS input script.</p>
<p>QuantumESPRESSO: distances and energies are in atomic units (Rydberg) for the pw.x module and atomic units (Hartree) for the cp.x module.</p>
<h1><a class="anchor" id="input"></a>
Input file</h1>
<p>A typical <code>plumed.dat</code> file is composed by specification of one or more CVs, the printout frequency and a termination line.</p>
<pre class="fragment"># printout frequency
PRINT W_STRIDE 10
# specify a torsion
TORSION LIST 5 7 9 15
# the end of plumed input
ENDPLUMED
</pre><p>Comments are denoted with a # and the termination of the input for plumed is marked with the keyword <code>ENDPLUMED</code>. Whatever follows is ignored by plumed. You can introduce blank lines, as they are not interpreted by plumed.</p>
<p>The line that starts with the keyword <code>PRINT</code> controls the frequency for the main plumed output file which is called <code>COLVAR</code>. This file contains the data regarding the collective variable positions, the constraint positions, the energy of hills and energy of constraints and other useful informations that will be introduced time by time during the tutorial. The frequency for writing is controlled by <code>W_STRIDE</code> followed by a number that represents the <em>number of steps</em> between one printout and the other. All the informations are written to the <code>COLVAR</code>. If an old <code>COLVAR</code> file is detected, this is saved in a <code>COLVAR.old</code> file so as to prevent overwriting. As this tutorial is not intended to give a survey on the all CVs available in plumed but more on the things you can do with that, please do refer to the manual for specific CV related syntax.</p>
<h1><a class="anchor" id="groups"></a>
Groups</h1>
<p>Another useful feature is the use of the groups. It may happen that one want to calculate properties between group of atoms. In this case the argument of the keyword <code>LIST</code> can be replaced by some groups denoted by angle bracket <code>&lt;g1&gt;</code>. In this case plumed looks for a <em>group</em> in the plumed input.</p>
<p>For many variables groups can be used instead of atoms to indicate that the center of mass of those atoms should be used. For example, the following input is computing the torsional angle among atoms 5, 7, 9 ane the center of mass of the group of atoms 15, 16 and 17: </p>
<pre class="fragment"># printout frequency
PRINT W_STRIDE 10
# specify a torsion
TORSION LIST 5 7 9 &lt;g1&gt;
# specify a group
g1-&gt;
15 16 17
g1&lt;-
ENDPLUMED
</pre><p>Notice however that in some case the meaning of a group is different (e.g. for the CVs <code>COORD</code> and <code>HBONDS</code>). Check the documentation of each CV in the manual. The group syntax also allows for looping on the atoms as well. Please refer to the manual for this option.</p>
<h1><a class="anchor" id="monitoring"></a>
Monitoring collective variables</h1>
<p>As first example we perform a simple MD run of alanine dipeptide with AMBER99SB all atom force field. Here you can see the molecular structure.</p>
<div class="image">
<img src="diala.png" alt="diala.png"/>
</div>
<p>Its free energy landscape is conveniently depicted as function of the two dihedral angles <img class="formulaInl" alt="$\Phi$" src="form_0.png"/> and <img class="formulaInl" alt="$\Psi$" src="form_1.png"/> (also called "Ramachandan plot") and therefore in this exercise we just run simply plumed and control the two dihedral angles.</p>
<p>Now go the the directory <code>monitor/</code> of the tutorial. Here you have a LAMMPS input file (<code>input</code>) and a force field file (<code>data.input</code>). In this run we will perform 100 ps of NVT MD and check the evolution of the collective variables with this simple input. Here is the <code>plumed.dat</code> file </p>
<pre class="fragment"># printout frequency
PRINT W_STRIDE 10
# specify phi and psi
TORSION LIST 5 7 9 15
TORSION LIST 7 9 15 17
ENDPLUMED
</pre><p>To run the simulation just type </p>
<pre class="fragment">$ lmp_plumed &lt; input
</pre><p>A <code>plumed.out</code> file will be generated as </p>
<pre class="fragment">::::::::::::::::: READING PLUMED INPUT :::::::::::::::::
|-PRINTING ON COLVAR FILE EVERY 10 STEPS
|-INITIAL TIME OFFSET IS 0.000000 TIME UNITS

1-TORSION: (1st SET: 1 ATOMS), (2nd SET: 1 ATOMS), (3rd SET: 1 ATOMS) , (4th
SET: 1 ATOMS); 
|- 1st SET MEMBERS:  5 
|- 2nd SET MEMBERS:  7 
|- 3rd SET MEMBERS:  9 
|- 4th SET MEMBERS:  15 


2-TORSION: (1st SET: 1 ATOMS), (2nd SET: 1 ATOMS), (3rd SET: 1 ATOMS) , (4th
SET: 1 ATOMS); 
|- 1st SET MEMBERS:  7 
|- 2nd SET MEMBERS:  9 
|- 3rd SET MEMBERS:  15 
|- 4th SET MEMBERS:  17 

|-ANALYSIS: YOU WILL ONLY MONITOR YOUR CVs DYNAMICS
</pre><p>This tells you that everything is going fine. The index of atoms are parsed correctly and the printout is correctly understood. Now what you get is a <code>COLVAR</code> file that consists in the time evolution of the CVs. Its format looks something like this: </p>
<pre class="fragment">#! FIELDS time cv1 cv2 vbias vwall vext
     0.000     -2.845176229      3.140506206      0.000000000      ...
     2.000     -2.854964594      3.123953400      0.000000000      ...
     4.000     -2.866214931      3.107481518      0.000000000      ...
     6.000     -2.878660385      3.091753506      0.000000000      ...
     ...      
</pre><p> In the first line there is a simple remainder to the elements that you have in each column. Namely time first, then the value of the two CVs followed by the various additional potential energies introduced by plumed. In this case there is no additional potential introduced and therefore all those columns are zeros. Now you can plot the evolution of the CVs with gnuplot by using the command </p>
<pre class="fragment">$ gnuplot
gnuplot&gt; set xlabel "time (ps)"
gnuplot&gt; set ylabel "angle (rad)"
gnuplot&gt; p "./COLVAR" u 1:2 t "Phi" ,"" u 1:3 t "Psi"
</pre><p> and you'll get something like</p>
<div class="image">
<img src="plot_time.png" alt="plot_time.png"/>
</div>
<p>The system is clearly jumping back and forth between two states. You can also look at the region explored in the two dimensional CV space by using </p>
<pre class="fragment">$ gnuplot
gnuplot&gt; set xlabel "Phi (rad)"
gnuplot&gt; set ylabel "Psi (rad)"
gnuplot&gt; set xrange [-3.14:3.14]
gnuplot&gt; set yrange [-3.14:3.14]
gnuplot&gt; p "./COLVAR" u 2:3 t ""
</pre><div class="image">
<img src="rama.png" alt="rama.png"/>
</div>
<h1><a class="anchor" id="driver"></a>
Using the driver</h1>
<p>"Oh my god! I forgot to include that special CV!". No problem! Max Bonomi wrote the <code>driver</code> utility through which you may postprocess your run and calculate that special CV you forgot to include runtime. Of course, being limited to the points for which you actually have the trajectory you don't have much statistics unless you collect very often the trajectory points (absolutely not recommended unless you want your supervisor hating you). To use the driver you need a trajectory in <code>dcd</code> format and a structure file in <code>pdb</code> format. Let us assume that what you forget to calculate is now the distance for NME3:H (atom 18) - ACE1:O (atom 6) and ALA2:O (atom 16) - ALA2:H (atom 8) . Then a you have to produce a new plumed input <code>plumed2.dat</code> </p>
<pre class="fragment"># in the driver, each timestep corresponds to a frame in the trajectory file
PRINT W_STRIDE 1
# the two distances that you want to plot
DISTANCE LIST 18 6
DISTANCE LIST 16 8
ENDPLUMED
</pre><p> and by using the following command </p>
<pre class="fragment">$ driver -pdb diala.pdb -dcd diala.dcd -ncv 2 -nopbc -plumed plumed2.dat 
</pre><p> you get a new <code>COLVAR</code> file with the data you need and by now you should be able to check the data you are obtaining with gnuplot.</p>
<p>If you are a VMD user, you can take advantage of the <a href="http://multiscalelab.org/utilities/PlumedCVTool">PlumedCVTool</a> developed by Toni Giorgino, which allows you to directly analyze a trajectory loaded in VMD with the PLUMED driver. You will be able to select atoms using VMD syntax (very useful for complex groups) and VMD will take care of file conversions for you. This plugin is alreay contained in VMD-1.9. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jul 29 2013 13:06:13 for Plumed Tutorial (ASCMS, Sao Paulo, 2011) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
